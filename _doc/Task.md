2.0.0 重构进度
- 已经完成的
  - [x] 参数签名和验签机制
  - [x] 开放接口供第三方调用
  - [x] 将零散的上下文对象进行抽取为统一的上下文对象
  - [x] 拆分原有的策略类，实现粒度更细
  - [x] 去除用户概念，作为独立的支付网关使用， 不与其他系统产生耦合性
- 2023-12-31:
  - [x] 支付关闭相关逻辑
  - [x] 各支付通道补充相关未实现的逻辑
  - [x] 支付订单修复逻辑, 用于回调和同步不一致的情况处理
- 2024-01-01:
  - [x] 支付订单修复逻辑, 用于回调和支付同步后不一致的情况处理
- 2024-01-02:
  - [x] 添加管理端的各类`Controller`    
  - [x] 支持定时同步支付中订单状态, 借助订单超时任务
- 2024-01-03:
  - [x] 支付流程联调
  - [x] 支付同步和支付修复流程优化
  - [x] 支付平台全局性配置
- 2024-01-04:
  - [x] 支付同步时, 如果订单已经超时, 但状态还是待支付, 触发修复操作关闭订单
  - [x] 发起支付时, 如果已经超过订单超时时间, 但状态还是待支付, 触发同步和修复操作
  - [x] 支付宝关闭支付订单，如果网关已经关闭，会返回错误导致本地订单无法关闭
  - [x] 增加支付单关闭记录功能
  - [x] 支付单存在异步支付时, 支付时间需要读取支付网关的返回的时间
  - [x] 同步记录/关闭记录/修复记录 增加记录请求ID
- 2024-01-05:
  - [x] 支付同步日志记录, 无论同步成功还是失败, 以及修复成功还是失败, 都需要记录日志
  - [x] 超时自动取消功能联调, 先用spring定时任务实现, 通过支付同步实现
  - [x] 支付同步和修复时, 对一些模糊状态进行处理, 例如支付宝返回的订单未查到
  - [x] 待支付支付单定时同步状态, 先用spring定时任务实现, 通过支付同步实现
  - [x] 退款功能联调
- 2024-01-06:
  - [x] 订单取消/修复/取消/同步等操作添加分布式锁, 防止出现重复操作
  - [x] 增加支付修复记录
- 2024-01-07:
  - [x] 抽取签名工具类
  - [x] 增加消息通知机制(通知客户端)
- 2024-01-08:
  - [x] (前端) 更新代码为platform最新版本
  - [x] (前端) 接口配置
- 2024-01-09:
  - [x] (前端) 支付配置
- 2024-01-10:
  - [x] 支付常量数据维护
  - [x] (前端) 支付回调记录
- 2024-01-11:
  - [x] (前端) 支付关闭记录
  - [x] (前端) 支付修复记录
- 2024-01-12:
  - [x] (前端) 支付订单
  - [x] (前端) 退款订单
  - [x] (前端) 支付通道配置列表
- 2024-01-13:
  - [x] (前端) 微信/支付宝支付通道配置
  - [x] 支付通道支持停用
  - [x] 请求支付网关时区退款号以R开头, 用于与支付ID的区分
  - [x] (前端) 平台配置
- 2024-01-15:
  - [x] 优化支付相关订单和记录的查询条件
  - [x] 开放接口新增查询类接口
- 2024-01-16:
  - [x] 支付单涉及退款状态同步逻辑
- 2024-01-17:
  - [x] 支付宝和微信支付对账下载接口
- 2024-01-21:
  - [x] (对账) 微信对账文件解析
  - [x] (对账) 支付宝对账文件解析
  - [x] (对账) 对账策略类和定时任务
  - [x] (对账) 对账记录和明细保存
- 2024-01-22:
  - [x] (对账) 通用结构对账结构转换
  - [x] (对账) 对账列表页、操作按钮（手动创建、执行、重试）
- 2024-01-23:
  - [x] 支付对账收尾
  - [x] 支付退款调整为订单+明细
- 2024-01-24:
  - [x] 支付策略优化通道支付单和可退款信息相关关系
  - [x] 支付退款默认为退款中状态, 根据返回数据或回调来完成退款操作
  - [x] 拆分支付回调为支付和退款回调
- 2024-01-25:
  - [x] 支付修复策略优化存储记录信息
  - [x] 去除各通道支付记录，统一为通道支付记录
- 2024-01-26:
  - [x] 优化支付修复时的触发来源的获取
  - [x] 优化支付回调处理, 处理各种错误
  - [x] 调整支付修复策略, 拆分为支付和退款修复两大类
- 2024-01-28:
  - [x] 支付宝对账单下载异常排查-支付宝每日都会生成对账单, 哪怕为空, 也会生成
  - [x] 订单修复记录前端显示调整
- 2044-01-30:
  - [x] 退款接口更改为先落库, 后更新, 同时退款余额先先进行扣减, 根据退款状态进行处理
  - [x] 增加退款同步策略, 对退款中的状态的退款订单进行处理
  - [x] 修改退款补偿处理, 更改为退款粒度为整个退款单, 要不全部成功, 要不全部失败
  - [x] 支付通道对出现疑似退款的订单进行**报错提醒**, 通过退款同步进行补偿
- 2024-01-31:
    - [ ] 微信退款同步策略
    - [ ] 退款操作支持重试
2.0.1 版本内容
  - [ ] 支付流程也改为先落库后支付情况, 避免极端情况导致掉单
  - [ ] 完善各种同步支付方式
  - [ ] 增加聚合支付功能支持
  - [ ] 增加手机用户收银台功能
**任务池**
  - [ ] ~~微信退款状态不一致补偿~~
  - [ ] 支付SDK编写
  - [ ] 接入支付网关的演示项目
  - [ ] 支付宝关闭支付时支持撤销方式,
  - [ ] 支持转账操作, 通过支付通道专有参数进行实现, 转账时只能单个通道进行操作
  - [ ] 支付成功回调后, 如果订单已超时, 则进入待退款订单中，提示进行退款，或者自动退款
  - [ ] ~~退款状态同步逻辑~~
  - [ ] ~~支付状态同步处理考虑退款情况~~
  - [ ] 增加回调机制(通知客户端)
  - [ ] 增加消息通知机制(通知客户端)
  - [ ] 新增支付单预警功能, 处理支付单与网关状态不一致且无法自动修复的情况
  - [ ] 微信消息通知相关配置
  - [ ] 钉钉消息通知配置
  - [ ] 支付宝接口升级为V3接口
  - [ ] 微信支付接口更新为V3接口
  - [ ] 增加验签调试等功能的页面
  - [ ] 请求IP参数增加正则校验
  - [ ] 增加账户金额表, 记录每天每个通道的账户金额, 并且提供查询接口
